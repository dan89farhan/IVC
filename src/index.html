<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../src/assets/bootstrap-4.5.3-dist/css/bootstrap.min.css">

    <!-- Insert this line above script imports  -->
    <script>
        if (typeof module === 'object') {
            window.module = module;
            module = undefined;
        }
    </script>

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="../src/assets/lib/jquery-3.5.1.slim.min.js"></script>
    <script src="../src/assets/bootstrap-4.5.3-dist/js/bootstrap.bundle.min.js"></script>
    <script src="../src/assets/lib/jquery.validate.min.js"></script>

    <!-- Custom Js -->
    <script src="app.js"></script>


    <title>Indian Video Transcoder</title>

    <style>
        body {
            background: rgb(255, 239, 205);
            background: linear-gradient(338deg, rgba(255, 239, 205, 1) 0%, rgba(218, 254, 255, 1) 60%);
        }

        * {
            font-size: 14px;
            color: #000;
        }

        #notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 200px;
            padding: 20px;
            border-radius: 5px;
            background-color: white;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
        }

        .hidden {
            display: none;
        }

        .w-15 {
            width: 15%
        }

        .form-control {
            height: 25px;
        }

        input[type=range] {
            -webkit-appearance: none;
            padding: 5px 0;
            background-color: rgba(0, 0, 0, 0);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 300px;
            height: 1px;
            background: #000;
            border: none;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            border: none;
            height: 23px;
            width: 16px;
            border-radius: 50%;
            background: #007bff;
            margin-top: -10px;
        }

        input[type=range]:focus {
            outline: none;
        }

        input[type=range]:focus::-webkit-slider-runnable-track {
            background: #ccc;
        }

        .card {
            background-color: transparent;
            border: none !important;
        }

        .card-header,
        .card-body {
            background-color: transparent !important;
            border: none !important;
            padding-top: 0;
            padding-left: 0;
            padding-right: 0;
        }

        .card-body .col-sm {
            padding: 0 !important
        }

        .wrapper {
            width: 0;
            /*play with this value */
            height: 0;
            /*play with this value */
            border: none;
            overflow: hidden;
        }

        .browse {
            width: 0;
            opacity: 0;
            /* set to .5 or something so you can better position it as an overlay then back to zero again after you're done */
            -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";
            filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=0);
        }
    </style>
</head>

<body>
    <div id="carouselExampleSlidesOnly" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="./assets/img/india-flag.png" class="d-block w-100" alt="India Flag">
            </div>
        </div>
    </div>
    <div class="container">

        <form id="convertVideoForm" method="POST" enctype="multipart/form-data">
            <div class="row">
                <div class="col-sm">
                    <div class="form-group">
                        <label for="Select File" class="d-inline mr-2">Select Input File</label>
                        <input type="file" name="inputFile" class="form-control-file w-50 d-inline" id="Select File">
                    </div>
                </div>

                <div class="col-sm radiocls form-group">
                    <label for="" class="mr-2">Select Format</label>
                    <div class="form-check-inline">
                        <label class="form-check-label mb-1 mr-2" for="hls">
                            .hls
                        </label>
                        <input class="form-check-input" type="radio" name="encode" value="hls" id="hls" checked>
                    </div>
                </div>

                <div class="col-sm radiocls form-group">
                    <label for="" class="mr-2">Select Transcoder</label>
                    <div class="form-check-inline">
                        <label class="form-check-label mb-1 mr-2" for="h264">
                            .264
                        </label>
                        <input class="form-check-input" type="radio" name="trancoder" value="h264" id="h264" checked>
                    </div>
                    <div class="form-check-inline">
                        <label class="form-check-label mb-1 mr-2" for="t_265">
                            .265
                        </label>
                        <input class="form-check-input" type="radio" name="trancoder" value="libx265" id="t_265">
                    </div>
                </div>

                <!-- accordion start -->
                <div class="col-sm radiocls form-group">
                    <label class="d-block">Select Resolution</label>
                    <div id="accordion">
                        <div class="card">
                            <div class="card-header">
                                <a class="card-link" data-toggle="collapse" href="#collapseOne">
                                    1080 <input type="checkbox" value="1" name="resolution1080" id="resolution1080">
                                </a>
                            </div>
                            <div id="collapseOne" class="collapse show" data-parent="#accordion">
                                <div class="card-body">
                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Min: <span
                                                class="font-weight-bold text-primary bitrateminSpan1080"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemin1080" id="bitratemin1080"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Max: <span
                                                class="font-weight-bold text-primary bitratemaxSpan1080"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemax1080" id="bitratemax1080"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Buffer: <span
                                                class="font-weight-bold text-primary bitratebufferSpan1080"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratebuffer1080" id="bitratebuffer1080"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <div class="form-group">
                                            <label for="selectFolder1080" class="d-inline mr-2 wrapper">Output file name
                                            </label>
                                            <input type="text" name="outputFileName1080"
                                                class="form-control d-inline w-50" id="outputFileName1080"
                                                aria-describedby="outputFileHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <a class="collapsed card-link" data-toggle="collapse" href="#collapseTwo">
                                    720 <input type="checkbox" value="1" name="resolution720" id="resolution720">
                                </a>
                            </div>
                            <div id="collapseTwo" class="collapse" data-parent="#accordion">
                                <div class="card-body">
                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Min: <span
                                                class="font-weight-bold text-primary bitrateminSpan720"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemin720" id="bitratemin720"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Max: <span
                                                class="font-weight-bold text-primary bitratemaxSpan720"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemax720" id="bitratemax720"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Buffer: <span
                                                class="font-weight-bold text-primary bitratebufferSpan720"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratebuffer720" id="bitratebuffer720"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <div class="form-group">
                                            <label for="selectFolder720" class="d-inline mr-2 wrapper">Output file name
                                            </label>
                                            <input type="text" name="outputFileName720"
                                                class="form-control d-inline w-50" id="outputFileName720"
                                                aria-describedby="outputFileHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <a class="collapsed card-link" data-toggle="collapse" href="#collapseFour">
                                    480 <input type="checkbox" value="1" name="resolution480" id="resolution480">
                                </a>
                            </div>
                            <div id="collapseFour" class="collapse" data-parent="#accordion">
                                <div class="card-body">
                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Min: <span
                                                class="font-weight-bold text-primary bitrateminSpan480"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemin480" id="bitratemin480"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Max: <span
                                                class="font-weight-bold text-primary bitratemaxSpan480"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemax480" id="bitratemax480"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Buffer: <span
                                                class="font-weight-bold text-primary bitratebufferSpan480"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratebuffer480" id="bitratebuffer480"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <div class="form-group">
                                            <label for="selectFolder480" class="d-inline mr-2 wrapper">Output file name
                                            </label>
                                            <input type="text" name="outputFileName480"
                                                class="form-control d-inline w-50" id="outputFileName"
                                                aria-describedby="outputFileHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <a class="collapsed card-link" data-toggle="collapse" href="#collapseThree">
                                    360 <input type="checkbox" value="1" name="resolution360" id="resolution360">
                                </a>
                            </div>
                            <div id="collapseThree" class="collapse" data-parent="#accordion">
                                <div class="card-body">
                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Min: <span
                                                class="font-weight-bold text-primary bitrateminSpan360"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemin360" id="bitratemin360"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Max: <span
                                                class="font-weight-bold text-primary bitratemaxSpan360"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemax360" id="bitratemax360"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Buffer: <span
                                                class="font-weight-bold text-primary bitratebufferSpan360"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratebuffer360" id="bitratebuffer360"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <div class="form-group">
                                            <label for="selectFolder360" class="d-inline mr-2 wrapper">Output file name
                                            </label>
                                            <input type="text" name="outputFileName360"
                                                class="form-control d-inline w-50" id="outputFileName360"
                                                aria-describedby="outputFileHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <a class="collapsed card-link" data-toggle="collapse" href="#collapseFive">
                                    240 <input type="checkbox" value="1" name="resolution240" id="resolution240">
                                </a>
                            </div>
                            <div id="collapseFive" class="collapse" data-parent="#accordion">
                                <div class="card-body">
                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Min: <span
                                                class="font-weight-bold text-primary bitrateminSpan240"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemin240" id="bitratemin240"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Max: <span
                                                class="font-weight-bold text-primary bitratemaxSpan240"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratemax240" id="bitratemax240"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <label for="">Select Bit Rate Buffer: <span
                                                class="font-weight-bold text-primary bitratebufferSpan240"></span>
                                            mbps</label>

                                        <div class="d-flex justify-content-center">
                                            <div class="range-field w-100">
                                                <input name="bitratebuffer240" id="bitratebuffer240"
                                                    class="form-control-range" type="range" min="0" max="20"
                                                    step="0.1" />
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm radiocls form-group">
                                        <div class="form-group">
                                            <label for="selectFolder240" class="d-inline mr-2 wrapper">Output file name
                                            </label>
                                            <input type="text" name="outputFileName240"
                                                class="form-control d-inline w-50" id="outputFileName240"
                                                aria-describedby="outputFileHelp">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- accordion end -->

            </div>

            <div class="row">
                <div class="col-sm radiocls form-group">
                    <div class="form-check-inline">
                        <label for="gif" class="form-check-label mr-2">
                            GIF
                        </label>
                        <input class="form-check-input mr-3" type="checkbox" name="gif" id="gif" value="1">
                        <label for="start_time" class="mr-2">Time Start</label>
                        <input type="text" name="starttime" class="form-control w-15 mr-3" id="start_time" placeholder="HH:MM:SS">
                        <label for="end" class="mr-2">End</label>
                        <input type="text" name="end" class="form-control w-15" id="end" placeholder="HH:MM:SS">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm radiocls form-group">
                    <div class="form-check-inline">
                        <label class="form-check-label mr-2" for="thumbnail">
                            Thumbnail
                        </label>
                        <input class="form-check-input mr-3" type="checkbox" name="thumbnail" id="thumbnail" value="1">
                        <label for="totalNumberOfFrames" class="mr-2">Total Number of Frames</label>
                        <input type="text" name="totalNumberOfFrames" class="form-control w-15"
                            id="totalNumberOfFrames">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm mb-3">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </div>
            <div class="row">
                <div class="col-sm">
                    <div class="form-group">
                        <label for="outputLogFile">Output Log file</label>
                        <textarea name="outputLogFile" class="form-control" id="outputLogFile"
                            aria-describedby="outputLogFile" rows="5" disabled></textarea>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-sm mb-3">
                    <button type="button" onclick="clearLogs()" class="btn btn-primary">Clear Logs</button>
                </div>
            </div>
        </form>
    </div>

    <div id="notification" class="hidden">
        <p id="message"></p>
        <button id="close-button" onClick="closeNotification()">
            Close
        </button>
        <button id="restart-button" onClick="restartApp()" class="hidden">
            Restart
        </button>
    </div>

</body>


<script>
    $(`#convertVideoForm`).validate({
        errorClass: "text-danger",
        debug: false,
        rules: {
            inputFile: {
                required: true
            },
            selectFolder1080: {
                required: {
                    depends: function (element) {
                        return $(`#resolution1080`).is(':checked');
                    }
                }
            },
            outputFileName1080: {
                required: {
                    depends: function (element) {
                        return $(`#resolution1080`).is(':checked');
                    }
                }
            },
            selectFolder720: {
                required: {
                    depends: function (element) {
                        return $(`#resolution720`).is(':checked');
                    }
                }
            },
            outputFileName720: {
                required: {
                    depends: function (element) {
                        return $(`#resolution720`).is(':checked');
                    }
                }
            },
            selectFolder360: {
                required: {
                    depends: function (element) {
                        return $(`#resolution360`).is(':checked');
                    }
                }
            },
            outputFileName360: {
                required: {
                    depends: function (element) {
                        return $(`#resolution360`).is(':checked');
                    }
                }
            },
            selectFolder480: {
                required: {
                    depends: function (element) {
                        return $(`#resolution480`).is(':checked');
                    }
                }
            },
            outputFileName480: {
                required: {
                    depends: function (element) {
                        return $(`#resolution480`).is(':checked');
                    }
                }
            },
            selectFolder240: {
                required: {
                    depends: function (element) {
                        return $(`#resolution240`).is(':checked');
                    }
                }
            },
            outputFileName240: {
                required: {
                    depends: function (element) {
                        return $(`#resolution240`).is(':checked');
                    }
                }
            },
            starttime: {
                required: {
                    depends: function (element) {
                        return $("#gif").is(":checked");
                    }
                }
            },
            end: {
                required: {
                    depends: function (element) {
                        return $("#gif").is(":checked");
                    }
                }
            },
            totalNumberOfFrames: {
                required: {
                    depends: function (element) {
                        return $("#thumbnail").is(":checked");
                    }
                }
            }
        },
        messages: {
            inputFile: {
                required: "*Input File is required"
            },
            selectFolder1080: {
                required: "*Please select output directory",
            },
            outputFileName1080: {
                required: "*Please enter output file name",
            },
            selectFolder720: {
                required: "*Please select output directory",
            },
            outputFileName720: {
                required: "*Please enter output file name",
            },
            selectFolder360: {
                required: "*Please select output directory",
            },
            outputFileName360: {
                required: "*Please enter output file name",
            },
            selectFolder480: {
                required: "*Please select output directory",
            },
            outputFileName480: {
                required: "*Please enter output file name",
            },
            selectFolder240: {
                required: "*Please select output directory",
            },
            outputFileName240: {
                required: "*Please enter output file name",
            },
            starttime: {
                required: "*Start time is required"
            },
            end: {
                required: "*End is required"
            },
            totalNumberOfFrames: {
                required: "*Total Number Of Frames is required"
            }
        },
        errorPlacement: function (error, element) {
            if (element.is(":radio")) {
                error.appendTo(element.parents('.radiocls'));
            } else { // This is the default behavior 
                error.insertAfter(element);
            }
        },
        submitHandler: function (form) {
            let formData = new FormData(document.querySelector('form'));
            let formDataObj = {};
            for (var pair of formData.entries()) {
                formDataObj[pair[0]] = pair[1];
            }
            // console.log(formDataObj);
            convertVideo(formDataObj);
            return;
        }
    });

    $(document).ready(function () {

        const $valueSpan = $('.valueSpan');
        const $value = $('#slider11');
        $valueSpan.html($value.val());
        $value.on('input change', () => {

            $valueSpan.html($value.val());
        });

        const $bitrateminSpan1080 = $('.bitrateminSpan1080');
        const $bitratemin1080 = $('#bitratemin1080');
        $bitrateminSpan1080.html($bitratemin1080.val());
        $bitratemin1080.on('input change', () => {
            $bitrateminSpan1080.html($bitratemin1080.val());
        });

        const $bitratemanSpan1080 = $('.bitratemaxSpan1080');
        const $bitratemax1080 = $('#bitratemax1080');
        $bitratemanSpan1080.html($bitratemax1080.val());
        $bitratemax1080.on('input change', () => {
            $bitratemanSpan1080.html($bitratemax1080.val());
        });

        const $bitratebufferSpan1080 = $('.bitratebufferSpan1080');
        const $bitratebuffer1080 = $('#bitratebuffer1080');
        $bitratebufferSpan1080.html($bitratebuffer1080.val());
        $bitratebuffer1080.on('input change', () => {
            $bitratebufferSpan1080.html($bitratebuffer1080.val());
        });

        const $bitrateminSpan720 = $('.bitrateminSpan720');
        const $bitratemin720 = $('#bitratemin720');
        $bitrateminSpan720.html($bitratemin720.val());
        $bitratemin720.on('input change', () => {
            $bitrateminSpan720.html($bitratemin720.val());
        });

        const $bitratemanSpan720 = $('.bitratemaxSpan720');
        const $bitratemax720 = $('#bitratemax720');
        $bitratemanSpan720.html($bitratemax720.val());
        $bitratemax720.on('input change', () => {
            $bitratemanSpan720.html($bitratemax720.val());
        });

        const $bitratebufferSpan720 = $('.bitratebufferSpan720');
        const $bitratebuffer720 = $('#bitratebuffer720');
        $bitratebufferSpan720.html($bitratebuffer720.val());
        $bitratebuffer720.on('input change', () => {
            $bitratebufferSpan720.html($bitratebuffer720.val());
        });

        const $bitrateminSpan480 = $('.bitrateminSpan480');
        const $bitratemin480 = $('#bitratemin480');
        $bitrateminSpan480.html($bitratemin480.val());
        $bitratemin480.on('input change', () => {
            $bitrateminSpan480.html($bitratemin480.val());
        });

        const $bitratemanSpan480 = $('.bitratemaxSpan480');
        const $bitratemax480 = $('#bitratemax480');
        $bitratemanSpan480.html($bitratemax480.val());
        $bitratemax480.on('input change', () => {
            $bitratemanSpan480.html($bitratemax480.val());
        });

        const $bitratebufferSpan480 = $('.bitratebufferSpan480');
        const $bitratebuffer480 = $('#bitratebuffer480');
        $bitratebufferSpan480.html($bitratebuffer480.val());
        $bitratebuffer480.on('input change', () => {
            $bitratebufferSpan480.html($bitratebuffer480.val());
        });

        const $bitrateminSpan360 = $('.bitrateminSpan360');
        const $bitratemin360 = $('#bitratemin360');
        $bitrateminSpan360.html($bitratemin360.val());
        $bitratemin360.on('input change', () => {
            $bitrateminSpan360.html($bitratemin360.val());
        });

        const $bitratemanSpan360 = $('.bitratemaxSpan360');
        const $bitratemax360 = $('#bitratemax360');
        $bitratemanSpan360.html($bitratemax360.val());
        $bitratemax360.on('input change', () => {
            $bitratemanSpan360.html($bitratemax360.val());
        });

        const $bitratebufferSpan360 = $('.bitratebufferSpan360');
        const $bitratebuffer360 = $('#bitratebuffer360');
        $bitratebufferSpan360.html($bitratebuffer360.val());
        $bitratebuffer360.on('input change', () => {
            $bitratebufferSpan360.html($bitratebuffer360.val());
        });

        const $bitrateminSpan240 = $('.bitrateminSpan240');
        const $bitratemin240 = $('#bitratemin240');
        $bitrateminSpan240.html($bitratemin240.val());
        $bitratemin240.on('input change', () => {
            $bitrateminSpan240.html($bitratemin240.val());
        });

        const $bitratemanSpan240 = $('.bitratemaxSpan240');
        const $bitratemax240 = $('#bitratemax240');
        $bitratemanSpan240.html($bitratemax240.val());
        $bitratemax240.on('input change', () => {
            $bitratemanSpan240.html($bitratemax240.val());
        });

        const $bitratebufferSpan240 = $('.bitratebufferSpan240');
        const $bitratebuffer240 = $('#bitratebuffer240');
        $bitratebufferSpan240.html($bitratebuffer240.val());
        $bitratebuffer240.on('input change', () => {
            $bitratebufferSpan240.html($bitratebuffer240.val());
        });
    });
</script>

<!-- Insert this line after script imports -->
<script>
    if (window.module) module = window.module;

    $('.collapse').collapse();

    $('.card-header a input[type=checkbox]').on('click', function (e) {
        e.stopPropagation();
        $(this).parent().trigger('click'); // <---  HERE
    });

    $('#collapseOne').on('show.bs.collapse', function (e) {
        if (!$('.card-header a input[type=checkbox]').is(':checked')) {
            return false;
        }
    });
    $('#collapseTwo').on('show.bs.collapse', function (e) {
        if (!$('.card-header a input[type=checkbox]').is(':checked')) {
            return false;
        }
    });
    $('#collapseThree').on('show.bs.collapse', function (e) {
        if (!$('.card-header a input[type=checkbox]').is(':checked')) {
            return false;
        }
    });
    $('#collapseFour').on('show.bs.collapse', function (e) {
        if (!$('.card-header a input[type=checkbox]').is(':checked')) {
            return false;
        }
    });
    $('#collapseFive').on('show.bs.collapse', function (e) {
        if (!$('.card-header a input[type=checkbox]').is(':checked')) {
            return false;
        }
    });
</script>

</html>